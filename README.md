# SummarisedStats

## Introduction

The scripts in this repository aim to obtain the summary data obtained from the Philips Actiwatch data for each of the sleep participants, and consolidate them into a single Excel file.

## Functions of each scripts

There are three scripts that work hand in hand to produced the desired output. They are:

1) ```data_summariser.py```
2) ```data_exporter.py```
3) ```condensing_excel_output.py```

```data_summariser.py``` will open the csv and then iterate through the data that was obtained from the Philips Actiware software for each subject, and extract out the relevant data. The script will then calculate the minimum, maximum, mean, 25th, 50th (A.K.A median), and 75th percentile, as well as the standard deviation for each of the variables that were extracted.

```data_exporter.py``` will first create a folder called `formatted_data` within the location that houses the xlsx files generated by the Philips Actiware, then export the resultant summarised data as a table into their respective individual excel workbook based on the subject's code into the `formatted_data` folder.

If there are multiple subjects in the study, then ```condensing_excel_output.py``` will combine all of the excel files that were produced by the ```data_exporter.py``` script into a single Excel file called `Consolidated stats.xlsx`. `condensing_excel_output.py` will then send the individual xlsx files that were previously  generated by the `data_exporter.py` into the recycling bin.

## Pre-requisites

please ensure that you have the following software installed on your computer:

- Python 3.9+
- ```Pandas``` library installed
  - You may install pandas using pip via the following command in Command Prompt:
  ```pip install -U pandas```
- `xlsxwriter` module installed
  - You may enter the following command in the Command Prompt to install the module:
  ```pip install -U xlsxwriter```

## How to use

You will only need to change the settings in the ```data_exporter.py``` and ```condensing_excel_output.py```.

### data_exporter.py

In the `User Input` section of the script, edit the `working_directory` variable with the filepath containing the CSV outputs generated from Philips Actiware software. Replace all '\' symbols with '/' symbols (without the quotation marks) in the filepath if you are using Windows.

Edit the `location_of_manifest` variable with the filepath that points to the manifest location. Replace all '\' symbols with '/' symbols (without the quotation marks) in the filepath if you are using Windows.

Run the script. If you are using the default Python IDE, press 'F5' to run the script. If you are using a different IDE (e.g. Sublime Text or VSCode, etc.), use the respective IDE's keyboard shortcut to run the script.

The summarised xlsx files generated by this script is now located in the `formatted_data` folder.

### condensing_excel_output.py

After using the `data_exporter.py`, open `condensing_excel_output.py` using an IDE and edit the `working_directory` variable in the `user input` section with the filepath containing the summarised xlsx files. If you are using Windows, replace all '\' symbols with '/' (without the quotation marks).

Run the script. If you are using the IDE that came with Python, the keyboard shortcut is 'F5'. For other IDEs (e.g. Sublime Text, VSCode, etc), refer to the IDE's manual on the shortcut to run the file.

The consolidated excel file containing all the summarised stats will be generated.
